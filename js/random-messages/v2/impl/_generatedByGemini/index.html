<html>

<body>
  <style>
    /* CSS –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç—É (—Ç—Ä–∏–≥–µ—Ä–∞) */
    #infoTrigger {
      font-size: 18px;
      color: red;
      cursor: pointer;
      user-select: none;
      display: inline-block;
      padding: 5px;
      /* –ü–æ—á–∞—Ç–∫–æ–≤–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π, –ø–æ–∫–∏ JS –Ω–µ –≤–∏–∑–Ω–∞—á–∏—Ç—å, —â–æ –ø–æ–∫–∞–∑–∞—Ç–∏ */
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    /* –ö–ª–∞—Å –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç—Ä–∏–≥–µ—Ä–∞ */
    #infoTrigger.visible {
      visibility: visible;
      opacity: 1;
    }

    /* CSS –¥–ª—è —Å–ø–ª–∏–≤–∞—é—á–æ—ó –ø—ñ–¥–∫–∞–∑–∫–∏ (Toast) */
    .custom-popup {
      position: absolute;
      background-color: #f9f9f9;
      border: 1px solid #007bff;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      padding: 15px;
      border-radius: 8px;
      z-index: 1000;
      max-width: 250px;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .custom-popup.show {
      opacity: 1;
      visibility: visible;
    }

    .popup-icon {
      font-size: 24px;
      line-height: 1;
    }

    .close-btn {
      background: none;
      border: none;
      color: #aaa;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      position: absolute;
      top: 5px;
      right: 10px;
    }

    .close-btn:hover {
      color: #333;
    }
  </style>

  <span id="infoTrigger">Show product message again</span>

  <script>
    // --- –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ ---
    const RANDOM_MESSAGES = [
      'Great choice! You are the best',
      "Fantastic click! What's next?",
      'You found the secret message!',
      'Random response activated!',
      'Enjoy the information!',
      'Success! Mission accomplished.',
      'Another message added to the stack!',
      'Check out this cool new feature!'
    ];
    const RANDOM_ICONS = ['üåü', 'üí°', 'üöÄ', 'üéâ', 'üíñ', '‚úÖ', 'ü•≥', '‚ú®'];

    // --- –ì–ª–æ–±–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω ---
    const infoTrigger = document.getElementById('infoTrigger');
    const TIMEOUT_DURATION = 5000; // 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è –∞–≤—Ç–æ–∑–∞–∫—Ä–∏—Ç—Ç—è
    const POPUP_TRANSITION_TIME = 300; // –ß–∞—Å CSS –ø–µ—Ä–µ—Ö–æ–¥—É
    let activePopups = []; // –ú–∞—Å–∏–≤ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤ {element, timeoutId}

    // --- –•–µ–ª–ø–µ—Ä–∏ ---

    function getRandomItem(arr) {
      const randomIndex = Math.floor(Math.random() * arr.length);
      return arr[randomIndex];
    }

    /**
     * –ì–µ–Ω–µ—Ä—É—î –≤–∏–ø–∞–¥–∫–æ–≤—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–¥–∫–∞–∑–æ–∫ (–≤—ñ–¥ 1 –¥–æ 5).
     */
    function getRandomPopupCount() {
      return Math.floor(Math.random() * 5) + 1; // 1 to 5
    }

    /**
     * –ó–º—ñ–Ω—é—î –≤–∏–¥–∏–º—ñ—Å—Ç—å —Ç–µ–∫—Å—Ç—É-—Ç—Ä–∏–≥–µ—Ä–∞.
     * @param {boolean} isVisible - –ß–∏ –ø–æ–≤–∏–Ω–µ–Ω —Ç—Ä–∏–≥–µ—Ä –±—É—Ç–∏ –≤–∏–¥–∏–º–∏–º.
     */
    function toggleTriggerVisibility(isVisible) {
      if (isVisible) {
        infoTrigger.classList.add('visible');
      } else {
        infoTrigger.classList.remove('visible');
      }
    }


    /**
     * –ó–∞–∫—Ä–∏–≤–∞—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –ø—ñ–¥–∫–∞–∑–∫—É, –æ—á–∏—â–∞—î —Ç–∞–π–º–µ—Ä —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –º–æ–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç–∏ —Ç—Ä–∏–≥–µ—Ä.
     * @param {HTMLElement} popupElement - –ï–ª–µ–º–µ–Ω—Ç –ø—ñ–¥–∫–∞–∑–∫–∏, —è–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–∫—Ä–∏—Ç–∏.
     */
    function closePopup(popupElement) {
      // 1. –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ç–∞ –æ—á–∏—â–∞—î–º–æ —Ç–∞–π–º–µ—Ä
      const index = activePopups.findIndex(p => p.element === popupElement);
      if (index !== -1) {
        clearTimeout(activePopups[index].timeoutId);
        // –í–∏–¥–∞–ª—è—î–º–æ –∑ –º–∞—Å–∏–≤—É –∞–∫—Ç–∏–≤–Ω–∏—Ö
        activePopups.splice(index, 1);
      }

      // 2. –ê–Ω—ñ–º–∞—Ü—ñ—è –∑–Ω–∏–∫–Ω–µ–Ω–Ω—è
      popupElement.classList.remove('show');

      // 3. –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑ DOM –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø–µ—Ä–µ—Ö–æ–¥—É
      setTimeout(() => {
        popupElement.remove();

        // 4. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: –Ø–∫—â–æ –±—ñ–ª—å—à–µ –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö –ø—ñ–¥–∫–∞–∑–æ–∫, –ø–æ–∫–∞–∑—É—î–º–æ —Ç—Ä–∏–≥–µ—Ä
        if (activePopups.length === 0) {
          toggleTriggerVisibility(true);
        }
      }, POPUP_TRANSITION_TIME);
    }

    /**
     * –°—Ç–≤–æ—Ä—é—î –æ–¥–Ω—É –ø—ñ–¥–∫–∞–∑–∫—É.
     * @param {string} message - –¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
     * @param {string} icon - –Ü–∫–æ–Ω–∫–∞.
     * @returns {HTMLElement} –°—Ç–≤–æ—Ä–µ–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç –ø—ñ–¥–∫–∞–∑–∫–∏.
     */
    function createPopupElement(message, icon) {
      const popup = document.createElement('div');
      popup.className = 'custom-popup';

      const iconEl = document.createElement('span');
      iconEl.className = 'popup-icon';
      iconEl.textContent = icon;

      const messageEl = document.createElement('span');
      messageEl.textContent = message;

      const closeBtn = document.createElement('button');
      closeBtn.className = 'close-btn';
      closeBtn.textContent = '√ó';

      popup.appendChild(iconEl);
      popup.appendChild(messageEl);
      popup.appendChild(closeBtn);

      // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è
      closeBtn.addEventListener('click', () => closePopup(popup));

      return popup;
    }


    /**
     * –°—Ç–≤–æ—Ä—é—î —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —Å—Ç–µ–∫ –ø—ñ–¥–∫–∞–∑–æ–∫ (–≤—ñ–¥ 1 –¥–æ 5).
     */
    function showPopupStack() {
      // –Ø–∫—â–æ –ø—ñ–¥–∫–∞–∑–∫–∏ –≤–∂–µ —î, —ñ–≥–Ω–æ—Ä—É—î–º–æ –∫–ª—ñ–∫
      if (activePopups.length > 0) {
        return;
      }

      // 1. –•–æ–≤–∞—î–º–æ —Ç—Ä–∏–≥–µ—Ä
      toggleTriggerVisibility(false);

      // 2. –í–∏–∑–Ω–∞—á–∞—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–¥–∫–∞–∑–æ–∫
      const count = getRandomPopupCount();

      // 3. –í–∏–∑–Ω–∞—á–∞—î–º–æ –ø–æ–∑–∏—Ü—ñ—é –ø–µ—Ä—à–æ—ó –ø—ñ–¥–∫–∞–∑–∫–∏ (–Ω–∞–¥ —Ç—Ä–∏–≥–µ—Ä–æ–º)
      const rect = infoTrigger.getBoundingClientRect();

      // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç–∞–π–º–∞—É—Ç, —â–æ–± –¥–∞—Ç–∏ –±—Ä–∞—É–∑–µ—Ä—É —á–∞—Å –Ω–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥,
      // –ø–µ—Ä—à –Ω—ñ–∂ –æ–±—á–∏—Å–ª—é–≤–∞—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.
      setTimeout(() => {
        let currentOffsetTop = rect.top + window.scrollY; // –ü–æ—á–∞—Ç–∫–æ–≤–∞ –ø–æ–∑–∏—Ü—ñ—è (–≤–µ—Ä—Ö–Ω—è –º–µ–∂–∞ —Ç—Ä–∏–≥–µ—Ä–∞)

        for (let i = 0; i < count; i++) {
          const randomMessage = getRandomItem(RANDOM_MESSAGES);
          const randomIcon = getRandomItem(RANDOM_ICONS);
          const popup = createPopupElement(randomMessage, randomIcon);

          document.body.appendChild(popup);

          const popupWidth = popup.offsetWidth;
          const popupHeight = popup.offsetHeight;

          // 4. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó
          // –ü–æ–∑–∏—Ü—ñ—è –ø–µ—Ä—à–æ—ó –ø—ñ–¥–∫–∞–∑–∫–∏ (i=0) - –Ω–∞ –º—ñ—Å—Ü—ñ —Ç—Ä–∏–≥–µ—Ä–∞, –∑—Å—É–Ω—É—Ç–∞ –≤–≥–æ—Ä—É.
          // –ù–∞—Å—Ç—É–ø–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏ –∑–º—ñ—â—É—é—Ç—å—Å—è –≤–≥–æ—Ä—É –Ω–∞ –≤–∏—Å–æ—Ç—É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó + –Ω–µ–≤–µ–ª–∏–∫–∏–π –≤—ñ–¥—Å—Ç—É–ø (10px).
          if (i === 0) {
            // –ü–µ—Ä—à–∞ –ø—ñ–¥–∫–∞–∑–∫–∞: 10px –Ω–∞–¥ —Ç—Ä–∏–≥–µ—Ä–æ–º
            currentOffsetTop = rect.top + window.scrollY - popupHeight - 10;
          } else {
            // –ö–æ–∂–Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∞ –ø—ñ–¥–∫–∞–∑–∫–∞: 10px –Ω–∞–¥ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—é
            currentOffsetTop -= (popupHeight + 10);
          }

          // 5. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó (—Ü–µ–Ω—Ç—Ä—É—î–º–æ –Ω–∞–¥ —Ç—Ä–∏–≥–µ—Ä–æ–º)
          popup.style.left = `${rect.left + window.scrollX + rect.width / 2 - popupWidth / 2
            }px`;
          popup.style.top = `${currentOffsetTop}px`;


          // 6. –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
          popup.classList.add('show');

          // 7. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–∑–∞–∫—Ä–∏—Ç—Ç—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω—É
          const timeoutId = setTimeout(() => closePopup(popup), TIMEOUT_DURATION);
          activePopups.push({ element: popup, timeoutId: timeoutId });
        }
      }, 1);
    }

    // --- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π ---

    // 1. –ü—Ä–∏–≤'—è–∑–∫–∞ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ –∫–ª—ñ–∫—É
    infoTrigger.addEventListener('click', showPopupStack);

    // 2. –í–∏–º–æ–≥–∞ 2: –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—ñ–¥–∫–∞–∑–æ–∫ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
    // –í–∏–∫–ª–∏–∫–∞—î–º–æ showPopupStack, —è–∫ —Ç—ñ–ª—å–∫–∏ DOM –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å—Å—è
    document.addEventListener('DOMContentLoaded', showPopupStack);

  </script>
</body>

</html>